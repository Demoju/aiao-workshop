# Requirements Document - 테이블오더 서비스

## Intent Analysis Summary

### User Request
테이블오더 서비스 구축 - 디지털 주문 시스템 (고객용 주문 인터페이스 + 관리자용 관리 시스템)

### Request Type
New Project (Greenfield)

### Scope Estimate
System-wide - 전체 시스템 구축 (Frontend + Backend + Database)

### Complexity Estimate
Complex - 다중 사용자 인터페이스, 실시간 통신, 세션 관리, 인증/인가

---

## 1. Functional Requirements

### 1.1 고객용 기능 (Customer Features)

#### FR-1.1: 테이블 태블릿 자동 로그인 및 세션 관리
- **초기 설정** (관리자가 1회 수행):
  - 매장 식별자 입력
  - 테이블 번호 입력
  - 테이블 비밀번호 입력
  - 로그인 정보 SessionStorage에 저장
- **자동 로그인**: 저장된 정보로 자동 로그인
- **세션 시작**: 첫 주문 생성 시 자동으로 테이블 세션 시작

#### FR-1.2: 메뉴 조회 및 탐색
- 메뉴 화면이 기본 화면으로 표시
- 카테고리별 메뉴 분류 및 표시
- 메뉴 상세 정보 표시:
  - 메뉴명
  - 가격
  - 메뉴 설명
  - 메뉴 이미지 (AWS S3에서 호스팅)
- 카테고리 간 빠른 이동
- 카드 형태의 메뉴 레이아웃
- 터치 친화적인 버튼 크기 (최소 44x44px)
- 반응형 디자인 (모든 디바이스 지원)

#### FR-1.3: 장바구니 관리
- 메뉴 추가/삭제
- 수량 조절 (증가/감소)
- 총 금액 실시간 계산
- 장바구니 비우기
- LocalStorage에 저장 (페이지 새로고침 시에도 유지)
- 서버 전송은 주문 확정 시에만 수행

#### FR-1.4: 주문 생성
- 주문 내역 최종 확인
- 주문 확정 버튼
- **주문 성공 플로우**:
  - 주문 번호 표시
  - 장바구니 자동 비우기
  - 메뉴 화면으로 자동 리다이렉트
- 주문 실패 시 에러 메시지 표시 및 장바구니 유지
- **주문 정보 포함 항목**:
  - 매장 식별 정보
  - 테이블 식별 정보
  - 주문 메뉴 목록 (메뉴명, 수량, 단가)
  - 총 주문 금액
  - 세션 ID

#### FR-1.5: 주문 내역 조회
- 주문 시간 순 정렬
- 주문별 상세 정보 표시:
  - 주문 번호
  - 주문 시각
  - 주문 메뉴 및 수량
  - 주문 금액
  - 주문 상태 (대기중/준비중/완료)
- 현재 테이블 세션 주문만 표시 (이전 세션 제외)
- 매장 이용 완료 처리된 주문은 제외
- 페이지네이션 또는 무한 스크롤

#### FR-1.6: 주문 취소 (추가 요구사항)
- 주문 수락 전인 경우 고객이 주문 취소 가능
- 취소 확인 팝업 표시
- 취소 성공 시 주문 내역에서 제거

### 1.2 관리자용 기능 (Admin Features)

#### FR-2.1: 매장 인증
- 매장 식별자 입력
- 사용자명 및 비밀번호 입력
- JWT 토큰 기반 인증
- 16시간 세션 유지
- 브라우저 새로고침 시 세션 유지
- 16시간 후 자동 로그아웃
- 비밀번호 bcrypt 해싱

#### FR-2.2: 실시간 주문 모니터링
- Server-Sent Events (SSE) 기반 실시간 업데이트
- **그리드/대시보드 레이아웃**:
  - 테이블별 카드 형태 표시
  - 각 테이블 카드에 총 주문액 표시
  - 최신 주문 n개 미리보기
- 주문별 상세 정보 표시:
  - 테이블 번호
  - 주문 번호
  - 주문 시각
  - 주문 메뉴 및 수량 (축약)
  - 총 금액
- 주문 카드 클릭 시 전체 메뉴 목록 상세 보기
- 주문 상태 변경 (대기중/준비중/완료)
- 신규 주문 시각적 강조 (색상 변경, 애니메이션)
- 3초 이내 주문 표시
- 테이블별 필터링 기능
- 반응형 디자인 (모든 디바이스 지원)

#### FR-2.3: 테이블 관리
**1. 테이블 태블릿 초기 설정**:
- 테이블 번호 및 테이블 비밀번호 설정
- 16시간 세션 생성
- 설정 정보 저장 및 자동 로그인 활성화

**2. 주문 삭제 (직권 수정)**:
- 특정 주문 삭제 버튼
- 확인 팝업 표시
- 주문 즉시 삭제
- 테이블 총 주문액 재계산
- 성공/실패 피드백

**3. 테이블 세션 처리**:
- 테이블 세션 시작 및 종료 관리
- 확인 팝업 표시
- 테이블 세션 종료 시 해당 세션의 주문 내역을 과거 이력으로 이동
- 테이블 세션 종료 시 테이블 현재 주문 목록 및 총 주문액 0으로 리셋
- 새 고객이 이전 주문 내역 없이 시작 가능
- 성공/실패 피드백

**4. 과거 주문 내역 조회**:
- "과거 내역" 버튼
- 테이블별 과거 주문 목록 표시 (시간 역순)
- 각 주문 정보: 주문 번호, 시각, 메뉴 목록, 총 금액, 매장 이용 완료 시각
- 날짜 필터링 기능
- "닫기" 버튼으로 대시보드 복귀
- 과거 주문 내역 1년간 보관

#### FR-2.4: 메뉴 관리 (MVP - 조회만)
- 메뉴 조회 (카테고리별)
- 메뉴 정보 표시:
  - 메뉴명
  - 가격
  - 설명
  - 카테고리
  - 이미지 URL
- **MVP 범위**: 메뉴 등록/수정/삭제는 향후 구현

---

## 2. Non-Functional Requirements

### NFR-1: Performance
- **주문 처리 응답 시간**: 3초 이내
- **실시간 주문 업데이트**: 3초 이내 표시
- **동시 접속 테이블 수**: 10개 이하 (소규모 매장)
- **페이지 로딩 시간**: 2초 이내

### NFR-2: Security
- **인증**: JWT 토큰 기반 (16시간 유효)
- **비밀번호 해싱**: bcrypt 알고리즘
- **세션 관리**: 
  - 관리자: JWT 토큰 (16시간)
  - 고객: SessionStorage 기반 자동 로그인
- **HTTPS**: 프로덕션 환경에서 필수
- **입력 검증**: 모든 사용자 입력 검증 및 sanitization

### NFR-3: Scalability
- **수평 확장**: Docker 컨테이너 기반 배포
- **데이터베이스**: PostgreSQL (관계형 데이터 모델)
- **이미지 저장**: AWS S3 (확장 가능한 스토리지)

### NFR-4: Usability
- **반응형 디자인**: 모든 디바이스 지원 (데스크톱, 태블릿, 스마트폰)
- **터치 친화적**: 최소 44x44px 버튼 크기
- **직관적 UI**: 명확한 시각적 계층 구조
- **다국어 지원**: 한국어 + 영어

### NFR-5: Reliability
- **에러 처리**: 모든 에러 상황에 대한 사용자 피드백
- **데이터 일관성**: 트랜잭션 기반 주문 처리
- **세션 복구**: 브라우저 새로고침 시 세션 유지

### NFR-6: Maintainability
- **코드 품질**: TDD (Test-Driven Development) 적용
- **테스트 커버리지**: Unit 테스트
- **문서화**: API 문서, 설치 가이드, 사용자 매뉴얼
- **버전 관리**: Git 기반

### NFR-7: Deployment
- **배포 환경**: 로컬 서버 (Docker Compose)
- **컨테이너화**: Docker 사용
- **데이터베이스**: PostgreSQL 컨테이너
- **이미지 스토리지**: AWS S3

---

## 3. Technical Stack

### 3.1 Backend
- **Framework**: Java Spring Boot
- **Authentication**: JWT
- **Password Hashing**: bcrypt
- **Real-time Communication**: Server-Sent Events (SSE)
- **Database**: PostgreSQL
- **ORM**: MyBatis

### 3.2 Frontend
- **Framework**: React
- **State Management**: React Context API or Redux
- **HTTP Client**: Axios or Fetch API
- **Local Storage**: LocalStorage (장바구니), SessionStorage (로그인 정보)
- **Styling**: CSS Modules or Styled Components or Tailwind CSS

### 3.3 Infrastructure
- **Deployment**: Docker Compose (로컬 서버)
- **Database**: PostgreSQL (Docker 컨테이너)
- **Image Storage**: AWS S3
- **Reverse Proxy**: Nginx (optional)

### 3.4 Development Tools
- **Version Control**: Git
- **Testing**: JUnit (Backend), Jest + React Testing Library (Frontend)
- **Build Tools**: Maven or Gradle (Backend), npm or yarn (Frontend)

---

## 4. Data Model (High-Level)

### 4.1 Core Entities
- **Store**: 매장 정보
- **Table**: 테이블 정보
- **Menu**: 메뉴 정보
- **Category**: 메뉴 카테고리
- **Order**: 주문 정보
- **OrderItem**: 주문 항목 (메뉴 + 수량)
- **TableSession**: 테이블 세션 정보
- **Admin**: 관리자 정보

### 4.2 Key Relationships
- Store 1:N Table
- Store 1:N Menu
- Store 1:N Category
- Category 1:N Menu
- Table 1:N TableSession
- TableSession 1:N Order
- Order 1:N OrderItem
- Menu 1:N OrderItem

---

## 5. Constraints and Exclusions

### 5.1 제외 기능 (구현하지 않음)
- 결제 처리 (카드, 현금, 디지털 지갑)
- 결제 게이트웨이 연동
- 영수증 발행 및 출력
- 환불 처리
- 포인트/쿠폰 시스템
- 복잡한 사용자 인증 (OAuth, SNS 로그인)
- 다단계 인증 (2FA, OTP)
- 이미지 리사이징/최적화
- 푸시 알림, SMS 알림, 이메일 발송
- 주방 기능 (주문 전달, 재고 관리)
- 데이터 분석 및 대시보드
- 매출 리포트 생성
- 재고 관리 시스템
- 직원 관리 및 권한 설정
- 예약 시스템
- 고객 리뷰 시스템
- 외부 연동 (배달 플랫폼, POS 시스템)

### 5.2 MVP 범위
- **고객용**: 자동 로그인, 메뉴 조회, 장바구니, 주문 생성, 주문 내역 조회, 주문 취소
- **관리자용**: 매장 인증, 실시간 주문 모니터링, 테이블 관리, 메뉴 조회
- **메뉴 관리**: 조회만 포함 (등록/수정/삭제는 향후 구현)

---

## 6. User Scenarios

### 6.1 고객 시나리오
1. **첫 방문 고객**:
   - 관리자가 테이블 태블릿 초기 설정 (매장 ID, 테이블 번호, 비밀번호)
   - 고객이 메뉴 화면에서 메뉴 탐색
   - 장바구니에 메뉴 추가
   - 주문 확정
   - 주문 번호 확인 후 메뉴 화면으로 자동 이동
   - 추가 주문 가능

2. **재방문 고객 (같은 세션)**:
   - 자동 로그인 (SessionStorage)
   - 메뉴 화면에서 추가 주문
   - 주문 내역 조회로 이전 주문 확인

3. **주문 취소**:
   - 주문 내역에서 주문 확인
   - 주문 수락 전이면 취소 버튼 활성화
   - 취소 확인 팝업
   - 취소 완료

### 6.2 관리자 시나리오
1. **매장 오픈**:
   - 관리자 로그인 (매장 ID, 사용자명, 비밀번호)
   - 대시보드에서 테이블 상태 확인
   - 각 테이블 태블릿 초기 설정

2. **주문 처리**:
   - 실시간으로 새 주문 알림 (시각적 강조)
   - 주문 상세 내역 확인
   - 주문 상태 변경 (대기중 → 준비중 → 완료)

3. **테이블 정리**:
   - 고객 퇴장 후 "매장 이용 완료" 버튼 클릭
   - 확인 팝업
   - 테이블 주문 내역 과거 이력으로 이동
   - 테이블 리셋 (주문액 0)

4. **과거 내역 조회**:
   - "과거 내역" 버튼 클릭
   - 날짜 필터링
   - 특정 주문 상세 확인

---

## 7. Success Criteria

### 7.1 기능적 성공 기준
- 고객이 별도 로그인 없이 주문 가능
- 관리자가 실시간으로 주문 확인 가능
- 주문 처리 시간 3초 이내
- 모든 디바이스에서 정상 작동

### 7.2 기술적 성공 기준
- TDD 기반 Unit 테스트 작성
- Docker Compose로 로컬 배포 성공
- PostgreSQL 데이터 일관성 유지
- JWT 인증 정상 작동
- SSE 실시간 통신 정상 작동

### 7.3 사용성 성공 기준
- 직관적인 UI/UX
- 터치 친화적인 인터페이스
- 명확한 에러 메시지
- 반응형 디자인

---

## 8. Risks and Mitigation

### 8.1 기술적 리스크
- **SSE 연결 끊김**: 자동 재연결 로직 구현
- **동시성 문제**: 트랜잭션 및 락 메커니즘 사용
- **세션 만료**: 명확한 만료 메시지 및 재로그인 유도

### 8.2 사용성 리스크
- **복잡한 UI**: 사용자 테스트 및 피드백 반영
- **네트워크 지연**: 로딩 인디케이터 및 에러 처리

---

## 9. Future Enhancements (Post-MVP)

- 메뉴 관리 CRUD (등록, 수정, 삭제)
- 주문 상태 실시간 업데이트 (고객용)
- 결제 기능
- 주방 디스플레이 시스템
- 매출 리포트 및 분석
- 다국어 확장 (일본어, 중국어 등)
- 모바일 앱 (React Native)
- 푸시 알림
- 고객 리뷰 시스템

---

## Document Version
- **Version**: 1.0
- **Date**: 2026-02-09
- **Author**: AI-DLC Requirements Analysis
